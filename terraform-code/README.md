# DigitalOcean Kubernetes Terraform Deployment

## Overview
This Terraform configuration provisions a managed Kubernetes cluster on DigitalOcean. It creates a cluster named `ruhi-k8s-cluster` in the `sgp1` region, pins the Kubernetes version to `1.33.1-do.5`, and attaches a single node pool of size `s-1vcpu-2gb` with one worker node. The DigitalOcean provider version is constrained to `~> 2.0` to ensure compatibility.

## Repository Contents
- `main.tf` – declares the DigitalOcean provider and defines the `digitalocean_kubernetes_cluster.ruhi_k8s` resource along with its worker node pool.
- `variables.tf` – exposes the required `do_token` input variable that supplies the DigitalOcean API token.
- `terraform.tfvars` – example variable assignment for `do_token`. Replace with your own token or delete this file and rely on environment variables to avoid committing secrets.
- `.terraform.lock.hcl` – provider dependency lock file generated by `terraform init`.
- `terraform.tfstate` / `terraform.tfstate.backup` – local state files managed by Terraform. Treat them as sensitive because they contain cluster metadata and references to your token.

## Prerequisites
- Terraform CLI v1.3 or newer (tested with modern releases).
- A DigitalOcean account with an API token that has write access to Kubernetes.
- (Optional) `doctl` CLI to validate the cluster after provisioning.

## Authentication
Provide the DigitalOcean API token to Terraform via one of the following approaches:

```powershell
# PowerShell (current session)
$env:TF_VAR_do_token = "dop_v1_..."

# PowerShell (persist for future sessions)
[System.Environment]::SetEnvironmentVariable("TF_VAR_do_token","dop_v1_...","User")
```

```bash
# macOS / Linux
export TF_VAR_do_token="dop_v1_..."
```

Avoid committing real tokens to `terraform.tfvars`. If you keep the sample file in version control, replace its contents with placeholder text.

## Usage
1. Initialize the working directory. This downloads the DigitalOcean provider defined in `main.tf`.
   ```bash
   terraform init
   ```
2. Review planned changes before applying. This shows that a single Kubernetes cluster and node pool will be created.
   ```bash
   terraform plan
   ```
3. Provision the infrastructure. Confirm the apply prompt to create the cluster.
   ```bash
   terraform apply
   ```
4. (Optional) Verify the cluster in the DigitalOcean control panel or via `doctl kubernetes cluster list`.

## Expected Result
- One managed Kubernetes cluster appears in the `sgp1` region named `ruhi-k8s-cluster`.
- The cluster runs Kubernetes `1.33.1-do.5` and contains a worker pool named `worker-pool`.
- The worker pool launches one droplet of size `s-1vcpu-2gb`.
- Terraform state records the cluster ID and other metadata, enabling subsequent runs to detect drift or destroy the cluster.

## Cleanup
Destroy the infrastructure when it is no longer needed to avoid ongoing charges:
```bash
terraform destroy
```
Confirm the prompt to remove the cluster and associated node pool from your DigitalOcean account.

